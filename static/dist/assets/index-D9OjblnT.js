import{D as te,a as n,m as b}from"./options-TVirCqXg.js";import{_ as ae,u as oe,r as y,a as c,b as u,o as i,c as g,d as s,w as l,e as _,f as v,F as S,g as x,h as ne,t as N,i as D,p as se,j as le}from"./index-DAh-7xhF.js";import"./index-DKAxyFMG.js";const ce=w=>(se("data-v-b6134059"),w=w(),le(),w),ie={class:"navigation-demo"},de={class:"content-demo"},ue={style:{height:"1200px"}},_e={style:{"margin-left":"40px"}},pe=ce(()=>v("div",{style:{width:"40px",display:"inline-block"}},null,-1)),me={style:{width:"100%",height:"100%"}},he={__name:"index",setup(w){const F=oe(),$=t=>{F.push(t)},U=y({host_data:[]}),h=c("全部"),p=c("全部"),m=c("全部"),R=c(!1),q=c({}),I=()=>{n.defaults.baseURL=b;let t={};h.value!=="全部"&&h.value!==0&&(t.business=h.value),p.value!=="全部"&&p.value!==0&&(t.set=p.value),m.value!=="全部"&&m.value!==0&&(t.module=m.value);const e="/hosts?"+new URLSearchParams(t).toString();console.log(e),n.get(e).then(a=>{U.host_data=a.data.data}).catch(a=>{console.log(a)})};I();const A=c({count:U.length,limit:10}),H=te.map(t=>({...t})),j=t=>{console.log("handleRowSelect",t)};y({});const M=c({}),E=(t,e,a,d,T)=>{n.defaults.baseURL=b;const k=`host-info?host=${e.host_id}`;n.get(k).then(r=>{M.value=r.data}).catch(r=>{console.log(r)}),q.value=e,R.value=!0};c("search");const V=y([]);function O(){n.defaults.baseURL=b,n.get("business/").then(e=>{const a=e.data.data;a.unshift({biz_id:0,biz_name:"全部"}),V.splice(0,V.length,...a)}).catch(e=>{console.log(e)})}O();const z=y([]);function P(){n.defaults.baseURL=b;const e=`set?business=${h.value}`;n.get(e).then(a=>{const d=a.data.data;d.unshift({set_id:0,set_name:"全部"}),z.splice(0,z.length,...d)}).catch(a=>{console.log(a)})}const L=y([]);function X(){n.defaults.baseURL=b;const e=`module?set=${p.value}`;n.get(e).then(a=>{const d=a.data.data;d.unshift({module_id:0,module_name:"全部"}),L.splice(0,L.length,...d)}).catch(a=>{console.log(a)})}const G=t=>{console.log("selectChange",t),P(),p.value="全部",m.value="全部"},J=t=>{console.log("selectChange",t),X(),m.value="全部"},K=()=>{console.log("update CMDB"),n.defaults.baseURL=b,n.get("/sync-cmdb/").then(e=>{console.log(e.data)}).catch(e=>{console.log(e)})},B=c(!0),Q=c("top-bottom"),W=t=>{B.value=!t},Y=t=>{$({index:"/",search:"/search",backup:"/backup"}[t.key])};return(t,e)=>{const a=u("bk-menu-item"),d=u("bk-menu"),T=u("bk-sideslider"),C=u("bk-option"),k=u("bk-select"),r=u("bk-button"),Z=u("bk-table"),ee=u("bk-navigation");return i(),g("div",ie,[s(ee,{class:"navigation-demo-content","default-open":B.value,"navigation-type":Q.value,"side-title":"CC简易查询系统",onToggle:W},{menu:l(()=>[s(d,{collapse:B.value,"active-key":"index",onClick:Y},{default:l(()=>[s(a,{key:"index"},{default:l(()=>[_(" 主机查询 ")]),_:1}),s(a,{key:"search"},{default:l(()=>[_(" 文件查询 ")]),_:1}),s(a,{key:"backup"},{default:l(()=>[_(" 备份记录 ")]),_:1})]),_:1},8,["collapse"])]),default:l(()=>[v("div",de,[s(T,{isShow:R.value,"onUpdate:isShow":e[0]||(e[0]=o=>R.value=o),title:"主机信息",width:"50%","quick-close":""},{default:l(()=>[v("div",ue,[(i(!0),g(S,null,x(M.value.data,o=>(i(),g("div",_e,[v("p",null,N(o.bk_property_name)+": "+N(o.bk_property_value),1)]))),256))])]),_:1},8,["isShow"]),v("div",null,[_(" 业务 "),s(k,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=o=>h.value=o),class:"bk-select",onChange:G},{default:l(()=>[(i(!0),g(S,null,x(V,(o,f)=>(i(),D(C,{id:o.biz_id,key:f,name:o.biz_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),_(" 集群 "),s(k,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=o=>p.value=o),class:"bk-select",onChange:J},{default:l(()=>[(i(!0),g(S,null,x(z,(o,f)=>(i(),D(C,{id:o.set_id,key:f,name:o.set_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),_(" 模块 "),s(k,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=o=>m.value=o),class:"bk-select"},{default:l(()=>[(i(!0),g(S,null,x(L,(o,f)=>(i(),D(C,{id:o.module_id,key:f,name:o.module_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),s(r,{onClick:I,theme:"primary"},{default:l(()=>[_("查找")]),_:1}),pe,s(r,{onClick:K,theme:"success"},{default:l(()=>[_("同步最新")]),_:1})]),v("div",me,[s(Z,{columns:ne(H),data:U.host_data,pagination:A.value,"pagination-heihgt":60,onRowClick:E,onSelect:j,"show-overflow-tooltip":"",height:"100%"},null,8,["columns","data","pagination"])])])]),_:1},8,["default-open","navigation-type"])])}}},ve=ae(he,[["__scopeId","data-v-b6134059"]]);export{ve as default};
