import{S as j,a as o}from"./sidebar-D8kXLrzQ.js";import{_ as G,r as b,a as d,D as J,b as g,o as n,c as S,w as u,m as r,d as h,e as k,f as v,g as C,F as U,h as f,t as _,u as K,p as Q,i as W}from"./index-iaxITKps.js";const Y=w=>(Q("data-v-2777bcd6"),w=w(),W(),w),Z={style:{height:"1200px"}},ee={style:{"margin-left":"40px"}},te=Y(()=>k("div",{style:{width:"40px",display:"inline-block"}},null,-1)),ae={style:{width:"100%",height:"100%"}},se={__name:"index",setup(w){const V=b({host_data:[]}),p=d("全部"),i=d("全部"),c=d("全部"),R=d(!1),M=d({}),$=()=>{o.defaults.baseURL=r;let t={};p.value!=="全部"&&p.value!==0&&(t.business=p.value),i.value!=="全部"&&i.value!==0&&(t.set=i.value),c.value!=="全部"&&c.value!==0&&(t.module=c.value);const e="/hosts?"+new URLSearchParams(t).toString();console.log(e),o.get(e).then(s=>{V.host_data=s.data.data}).catch(s=>{console.log(s)})};$();const N=d({count:V.length,limit:10}),F=J.map(t=>({...t})),T=t=>{console.log("handleRowSelect",t)};b({});const I=d({}),q=(t,e,s,l,y)=>{o.defaults.baseURL=r;const D=`host-info?host=${e.host_id}`;o.get(D).then(a=>{I.value=a.data}).catch(a=>{console.log(a)}),M.value=e,R.value=!0};d("search");const z=b([]);function A(){o.defaults.baseURL=r,o.get("business/").then(e=>{const s=e.data.data;s.unshift({biz_id:0,biz_name:"全部"}),z.splice(0,z.length,...s)}).catch(e=>{console.log(e)})}A();const L=b([]);function H(){o.defaults.baseURL=r;const e=`set?business=${p.value}`;o.get(e).then(s=>{const l=s.data.data;l.unshift({set_id:0,set_name:"全部"}),L.splice(0,L.length,...l)}).catch(s=>{console.log(s)})}const x=b([]);function E(){o.defaults.baseURL=r;const e=`module?set=${i.value}`;o.get(e).then(s=>{const l=s.data.data;l.unshift({module_id:0,module_name:"全部"}),x.splice(0,x.length,...l)}).catch(s=>{console.log(s)})}const O=t=>{console.log("selectChange",t),H(),i.value="全部",c.value="全部"},P=t=>{console.log("selectChange",t),E(),c.value="全部"},X=()=>{console.log("update CMDB"),o.defaults.baseURL=r,o.get("/sync-cmdb/").then(e=>{console.log(e.data)}).catch(e=>{console.log(e)})};return(t,e)=>{const s=g("bk-sideslider"),l=g("bk-option"),y=g("bk-select"),B=g("bk-button"),D=g("bk-table");return n(),S(j,{active_key:"index"},{default:u(()=>[h(s,{isShow:R.value,"onUpdate:isShow":e[0]||(e[0]=a=>R.value=a),title:"主机信息",width:"50%","quick-close":""},{default:u(()=>[k("div",Z,[(n(!0),v(U,null,C(I.value.data,a=>(n(),v("div",ee,[k("p",null,_(a.bk_property_name)+": "+_(a.bk_property_value),1)]))),256))])]),_:1},8,["isShow"]),k("div",null,[f(_(t.$t("host.business"))+" ",1),h(y,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=a=>p.value=a),class:"bk-select",onChange:O},{default:u(()=>[(n(!0),v(U,null,C(z,(a,m)=>(n(),S(l,{id:a.biz_id,key:m,name:a.biz_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),f(" "+_(t.$t("host.set"))+" ",1),h(y,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=a=>i.value=a),class:"bk-select",onChange:P},{default:u(()=>[(n(!0),v(U,null,C(L,(a,m)=>(n(),S(l,{id:a.set_id,key:m,name:a.set_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),f(" "+_(t.$t("host.module"))+" ",1),h(y,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=a=>c.value=a),class:"bk-select"},{default:u(()=>[(n(!0),v(U,null,C(x,(a,m)=>(n(),S(l,{id:a.module_id,key:m,name:a.module_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),h(B,{onClick:$,theme:"primary"},{default:u(()=>[f(_(t.$t("host.search")),1)]),_:1}),te,h(B,{onClick:X,theme:"success"},{default:u(()=>[f(_(t.$t("host.sync")),1)]),_:1})]),k("div",ae,[h(D,{columns:K(F),data:V.host_data,pagination:N.value,"pagination-heihgt":60,onRowClick:q,onSelect:T,"show-overflow-tooltip":"",height:"100%"},null,8,["columns","data","pagination"])])]),_:1})}}},ne=G(se,[["__scopeId","data-v-2777bcd6"]]);export{ne as default};
