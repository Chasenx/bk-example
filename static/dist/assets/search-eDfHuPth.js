import{S as D,a as u}from"./sidebar-D8kXLrzQ.js";import{_ as N,r as g,a,j as A,b as v,o as B,c as H,w as k,e as n,h as p,t as h,d as i,u as P,m as w,p as q,i as E}from"./index-iaxITKps.js";const y=c=>(q("data-v-0e8dbbb2"),c=c(),E(),c),T={style:{width:"400px",display:"inline-block"}},j=y(()=>n("br",null,null,-1)),z={style:{width:"400px",display:"inline-block"}},M=y(()=>n("br",null,null,-1)),O={style:{width:"400px",display:"inline-block"}},F=y(()=>n("br",null,null,-1)),G={style:{width:"100%",height:"100%"}},J={__name:"search",setup(c){const d=g({host_data:[]});a("全部"),a("全部"),a("全部");const S=a(!1),x=a({}),V=a({count:d.length,limit:10}),R=A.map(t=>({...t})),U=t=>{console.log("handleRowSelect",t)};g({});const C=a({}),I=(t,e,o,s,r)=>{u.defaults.baseURL=w;const $=`host-info?host=${e.host_id}`;u.get($).then(f=>{C.value=f.data}).catch(f=>{console.log(f)}),x.value=e,S.value=!0},_=a("10.0.48.18,10.0.48.46"),b=a("/tmp"),m=a("log"),L=()=>{u.defaults.baseURL=w;let t={dir:b.value,suffix:m.value,hosts:_.value.replace(/(\r\n|\n|\r)/gm,",")};const e="/search-files?"+new URLSearchParams(t).toString();console.log(e),u.get(e).then(o=>{o.data.data.length>0&&(d.host_data=o.data.data,d.host_data.forEach(s=>{if(s.size>0){let r={dir:s.dir,files:s.filenames,hosts:s.ip};const l="/backup-files?"+new URLSearchParams(r).toString();s.operation=l}}))}).catch(o=>{console.log(o)})};return(t,e)=>{const o=v("bk-input"),s=v("bk-button"),r=v("bk-table");return B(),H(D,{active_key:"search"},{default:k(()=>[n("div",T,[p(h(t.$t("search.host_ip"))+" ",1),i(o,{style:{display:"inline-block"},modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),type:"textarea",placeholder:"请输入主机IP",class:"mb8"},null,8,["modelValue"])]),j,n("div",z,[p(h(t.$t("search.dir"))+" ",1),i(o,{style:{display:"inline-block"},modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=l=>b.value=l),type:"textarea",placeholder:"/tmp",class:"mb8"},null,8,["modelValue"])]),M,n("div",O,[p(h(t.$t("search.suffix"))+" ",1),i(o,{style:{display:"inline-block"},modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=l=>m.value=l),type:"textarea",placeholder:"log",class:"mb8"},null,8,["modelValue"])]),F,i(s,{onClick:L,theme:"success"},{default:k(()=>[p(h(t.$t("search.search_btn")),1)]),_:1}),n("div",G,[i(r,{columns:P(R),data:d.host_data,pagination:V.value,"pagination-heihgt":60,onRowClick:I,onSelect:U,"show-overflow-tooltip":"",height:"100%"},null,8,["columns","data","pagination"])])]),_:1})}}},W=N(J,[["__scopeId","data-v-0e8dbbb2"]]);export{W as default};
