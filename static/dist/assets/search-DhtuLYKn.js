import{a as b}from"./axios-Bo0ATomq.js";import{_ as H,u as q,r as x,a as o,l as M,b as u,o as z,c as O,d as a,w as i,e as c,f as n,h as $,m as S,i as j,p as F,k as G}from"./index-BgPYWdJM.js";import"./index-BG7Pc1-g.js";const w=r=>(F("data-v-6a96eead"),r=r(),G(),r),J={class:"navigation-demo"},K={class:"content-demo"},Q={style:{width:"400px",display:"inline-block"}},W=w(()=>n("br",null,null,-1)),X={style:{width:"400px",display:"inline-block"}},Y=w(()=>n("br",null,null,-1)),Z={style:{width:"400px",display:"inline-block"}},ee=w(()=>n("br",null,null,-1)),te={style:{width:"100%",height:"100%"}},oe={__name:"search",setup(r){const C=q(),V=e=>{C.push(e)},h=x({host_data:[]});o("全部"),o("全部"),o("全部");const R=o(!1),U=o({}),I=o({count:h.length,limit:10}),L=M.map(e=>({...e})),N=e=>{console.log("handleRowSelect",e)};x({});const P=o({}),T=(e,t,l,s,d)=>{b.defaults.baseURL=S;const y=`host-info?host=${t.host_id}`;b.get(y).then(p=>{P.value=p.data}).catch(p=>{console.log(p)}),U.value=t,R.value=!0},v=o(!0),A=o("top-bottom"),B=e=>{v.value=!e},D=e=>{V(j[e.key])},k=o("10.0.48.18,10.0.48.46"),f=o("/tmp"),g=o("log"),E=()=>{b.defaults.baseURL=S;let e={dir:f.value,suffix:g.value,hosts:k.value.replace(/(\r\n|\n|\r)/gm,",")};const t="/search-files?"+new URLSearchParams(e).toString();console.log(t),b.get(t).then(l=>{l.data.data.length>0&&(h.host_data=l.data.data,h.host_data.forEach(s=>{if(s.size>0){let d={dir:s.dir,files:s.filenames,hosts:s.ip};const m="/backup-files?"+new URLSearchParams(d).toString();s.operation=m}}))}).catch(l=>{console.log(l)})};return(e,t)=>{const l=u("bk-menu-item"),s=u("bk-menu"),d=u("bk-input"),m=u("bk-button"),y=u("bk-table"),p=u("bk-navigation");return z(),O("div",J,[a(p,{class:"navigation-demo-content","default-open":v.value,"navigation-type":A.value,"side-title":"CC简易查询系统",onToggle:B},{menu:i(()=>[a(s,{collapse:v.value,"active-key":"search",onClick:D},{default:i(()=>[a(l,{key:"index"},{default:i(()=>[c(" 主机查询 ")]),_:1}),a(l,{key:"search"},{default:i(()=>[c(" 文件查询 ")]),_:1}),a(l,{key:"backup"},{default:i(()=>[c(" 备份记录 ")]),_:1})]),_:1},8,["collapse"])]),default:i(()=>[n("div",K,[n("div",Q,[c(" 主机IP "),a(d,{style:{display:"inline-block"},modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=_=>k.value=_),type:"textarea",placeholder:"请输入主机IP",class:"mb8"},null,8,["modelValue"])]),W,n("div",X,[c(" 目录 "),a(d,{style:{display:"inline-block"},modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=_=>f.value=_),type:"textarea",placeholder:"/tmp",class:"mb8"},null,8,["modelValue"])]),Y,n("div",Z,[c(" 文件后缀 "),a(d,{style:{display:"inline-block"},modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=_=>g.value=_),type:"textarea",placeholder:"log",class:"mb8"},null,8,["modelValue"])]),ee,a(m,{onClick:E,theme:"success"},{default:i(()=>[c("立即查询")]),_:1}),n("div",te,[a(y,{columns:$(L),data:h.host_data,pagination:I.value,"pagination-heihgt":60,onRowClick:T,onSelect:N,"show-overflow-tooltip":"",height:"100%"},null,8,["columns","data","pagination"])])])]),_:1},8,["default-open","navigation-type"])])}}},ne=H(oe,[["__scopeId","data-v-6a96eead"]]);export{ne as default};
