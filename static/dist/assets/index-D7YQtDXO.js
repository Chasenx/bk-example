import{a as n}from"./axios-Bo0ATomq.js";import{_ as te,u as oe,r as y,a as i,D as ae,b as u,o as c,c as g,d as s,w as l,m as b,e as _,f as v,F as S,g as x,h as ne,i as se,t as N,j as D,p as le,k as ie}from"./index-BgPYWdJM.js";import"./index-BG7Pc1-g.js";const ce=w=>(le("data-v-0b30de18"),w=w(),ie(),w),de={class:"navigation-demo"},ue={class:"content-demo"},_e={style:{height:"1200px"}},pe={style:{"margin-left":"40px"}},me=ce(()=>v("div",{style:{width:"40px",display:"inline-block"}},null,-1)),he={style:{width:"100%",height:"100%"}},re={__name:"index",setup(w){const F=oe(),$=t=>{F.push(t)},U=y({host_data:[]}),h=i("全部"),p=i("全部"),m=i("全部"),R=i(!1),q=i({}),I=()=>{n.defaults.baseURL=b;let t={};h.value!=="全部"&&h.value!==0&&(t.business=h.value),p.value!=="全部"&&p.value!==0&&(t.set=p.value),m.value!=="全部"&&m.value!==0&&(t.module=m.value);const e="/hosts?"+new URLSearchParams(t).toString();console.log(e),n.get(e).then(o=>{U.host_data=o.data.data}).catch(o=>{console.log(o)})};I();const A=i({count:U.length,limit:10}),H=ae.map(t=>({...t})),j=t=>{console.log("handleRowSelect",t)};y({});const M=i({}),E=(t,e,o,d,T)=>{n.defaults.baseURL=b;const k=`host-info?host=${e.host_id}`;n.get(k).then(r=>{M.value=r.data}).catch(r=>{console.log(r)}),q.value=e,R.value=!0};i("search");const V=y([]);function O(){n.defaults.baseURL=b,n.get("business/").then(e=>{const o=e.data.data;o.unshift({biz_id:0,biz_name:"全部"}),V.splice(0,V.length,...o)}).catch(e=>{console.log(e)})}O();const z=y([]);function P(){n.defaults.baseURL=b;const e=`set?business=${h.value}`;n.get(e).then(o=>{const d=o.data.data;d.unshift({set_id:0,set_name:"全部"}),z.splice(0,z.length,...d)}).catch(o=>{console.log(o)})}const L=y([]);function X(){n.defaults.baseURL=b;const e=`module?set=${p.value}`;n.get(e).then(o=>{const d=o.data.data;d.unshift({module_id:0,module_name:"全部"}),L.splice(0,L.length,...d)}).catch(o=>{console.log(o)})}const G=t=>{console.log("selectChange",t),P(),p.value="全部",m.value="全部"},J=t=>{console.log("selectChange",t),X(),m.value="全部"},K=()=>{console.log("update CMDB"),n.defaults.baseURL=b,n.get("/sync-cmdb/").then(e=>{console.log(e.data)}).catch(e=>{console.log(e)})},B=i(!0),Q=i("top-bottom"),W=t=>{B.value=!t},Y=t=>{$(se[t.key])};return(t,e)=>{const o=u("bk-menu-item"),d=u("bk-menu"),T=u("bk-sideslider"),C=u("bk-option"),k=u("bk-select"),r=u("bk-button"),Z=u("bk-table"),ee=u("bk-navigation");return c(),g("div",de,[s(ee,{class:"navigation-demo-content","default-open":B.value,"navigation-type":Q.value,"side-title":"CC简易查询系统",onToggle:W},{menu:l(()=>[s(d,{collapse:B.value,"active-key":"index",onClick:Y},{default:l(()=>[s(o,{key:"index"},{default:l(()=>[_(" 主机查询 ")]),_:1}),s(o,{key:"search"},{default:l(()=>[_(" 文件查询 ")]),_:1}),s(o,{key:"backup"},{default:l(()=>[_(" 备份记录 ")]),_:1})]),_:1},8,["collapse"])]),default:l(()=>[v("div",ue,[s(T,{isShow:R.value,"onUpdate:isShow":e[0]||(e[0]=a=>R.value=a),title:"主机信息",width:"50%","quick-close":""},{default:l(()=>[v("div",_e,[(c(!0),g(S,null,x(M.value.data,a=>(c(),g("div",pe,[v("p",null,N(a.bk_property_name)+": "+N(a.bk_property_value),1)]))),256))])]),_:1},8,["isShow"]),v("div",null,[_(" 业务 "),s(k,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=a=>h.value=a),class:"bk-select",onChange:G},{default:l(()=>[(c(!0),g(S,null,x(V,(a,f)=>(c(),D(C,{id:a.biz_id,key:f,name:a.biz_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),_(" 集群 "),s(k,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=a=>p.value=a),class:"bk-select",onChange:J},{default:l(()=>[(c(!0),g(S,null,x(z,(a,f)=>(c(),D(C,{id:a.set_id,key:f,name:a.set_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),_(" 模块 "),s(k,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=a=>m.value=a),class:"bk-select"},{default:l(()=>[(c(!0),g(S,null,x(L,(a,f)=>(c(),D(C,{id:a.module_id,key:f,name:a.module_name},null,8,["id","name"]))),128))]),_:1},8,["modelValue"]),s(r,{onClick:I,theme:"primary"},{default:l(()=>[_("查找")]),_:1}),me,s(r,{onClick:K,theme:"success"},{default:l(()=>[_("同步最新")]),_:1})]),v("div",he,[s(Z,{columns:ne(H),data:U.host_data,pagination:A.value,"pagination-heihgt":60,onRowClick:E,onSelect:j,"show-overflow-tooltip":"",height:"100%"},null,8,["columns","data","pagination"])])])]),_:1},8,["default-open","navigation-type"])])}}},ke=te(re,[["__scopeId","data-v-0b30de18"]]);export{ke as default};
